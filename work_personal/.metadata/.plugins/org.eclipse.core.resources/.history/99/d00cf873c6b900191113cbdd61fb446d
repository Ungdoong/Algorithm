package d5;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.util.ArrayList;
import java.util.StringTokenizer;

public class Solution_d5_1242_암호코드스캔_서울8반_정택진 {
	public static final String[] numbers= {"0001101","0011001","0010011"
			,"0111101","0100011","0110001","0101111","0111011","0110111","0001011"};
	public static String[] numbers2=new String[10];
	public static void main(String[] args) throws Exception{
		System.setIn(new FileInputStream("res/input_d5_1242.txt"));
		BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
		BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(System.out));
		int T=Integer.parseInt(br.readLine());

		StringBuilder sb;
		for(int i=0; i<numbers2.length; i++) {
			sb=new StringBuilder();
			for(int j=0; j<7; j++) {
				sb.append(numbers[i].charAt(j))
				  .append(numbers[i].charAt(j));
			}
			numbers2[i]=sb.toString();
		}
		
		int start_code=0; int end_code=0; int count=0;
		for(int tc=1; tc<=5; tc++) {
			StringTokenizer st=new StringTokenizer(br.readLine());
			int Y=Integer.parseInt(st.nextToken());
			int X=Integer.parseInt(st.nextToken());
			
			//codes 리스트에 코드 삽입
			ArrayList<String> codes= new ArrayList<String>();
			for(int i=0; i<Y; i++) {
				String line=br.readLine();
				for(int j=0; j<line.length(); j++) {
					if(line.charAt(j)!='0') {
						count=0;
						if(start_code == 0)		start_code = j;
						else if(end_code < j)	end_code = j;
					}
					else if((count >= 3 || j == line.length()-1)&& start_code != 0 && end_code != 0) {
						String code="00" + line.substring(start_code, end_code+1);
						if(!codes.contains(code))
							codes.add(code);
						start_code = 0;
						end_code = 0;
					}else count++;
				}
			}
			System.out.println(codes);
			
			//2진수로 변환 및 길이 정제
			for(int i=0; i<codes.size(); i++) {
				String code = codes.get(i);
				int len=(code.length()-1)/16;
				for(int j=0; j<=len; j++) {
					if(j == len) {
						String s=code.substring(j*16,code.length());
						Long hex=Long.parseUnsignedLong(s, 16);
						StringBuilder bin=new StringBuilder(Long.toBinaryString(hex));
						while(bin.charAt(bin.length()-1) == '0')
							bin.deleteCharAt(bin.length()-1);
						int last=56-bin.length()%56;
//						while(last-- > 0)
//							bin.insert(0, "0", 0, 1);
						codes.remove(i);
						codes.add(i, bin.toString());
						System.out.println(codes);
					}
				}
			}
			
			System.out.println(codes);
			
		}
	}
}